<h1>Build Pipeline Optimizations</h1><p>This document outlines all optimizations implemented in the build pipeline.<h2>Current Optimizations</h2><h3>âœ… Implemented</h3><ol><li><p><strong>HTML Minification</strong> - Using <code>html-minifier-next</code><ul><li>Removes whitespace, comments, optional tags<li>Minifies inline CSS and JS<li>Reduces HTML size by ~20-30%</ul><li><p><strong>JavaScript Minification</strong> - Using <code>terser</code><ul><li>Removes console.log in production<li>Mangles variable names<li>Compresses code<li>Reduces JS size by ~40-60%</ul><li><p><strong>CSS Minification</strong> - Using <code>csso</code><ul><li>Removes whitespace and comments<li>Optimizes selectors<li>Reduces CSS size by ~20-30%</ul><li><p><strong>Critical CSS Extraction</strong> - Inlines critical CSS<ul><li>Extracts above-the-fold CSS<li>Inlines in <code>&lt;head></code> for faster FCP<li>Loads full CSS asynchronously</ul><li><p><strong>Image Optimization</strong> - Using <code>sharp</code><ul><li>Compresses JPEG (quality 85, progressive)<li>Optimizes PNG (compression level 9)<li>Reduces image size by ~30-50%</ul><li><p><strong>Font Subsetting</strong> - Using <code>glyphhanger</code><ul><li>Analyzes HTML to find used characters<li>Subsets fonts to include only needed characters<li>Reduces font file sizes by 70-90%</ul><li><p><strong>Service Worker</strong> - Caching and offline support<ul><li>Caches static assets (CSS, JS, images, fonts)<li>Cache-first strategy for static assets<li>Network-first strategy for HTML<li>Enables offline functionality<li>Reduces load times by 50-80% on repeat visits</ul><li><p><strong>Asset Cleanup</strong> - Removes unused files<ul><li>Removes source files from output<li>Cleans up development artifacts</ul><li><p><strong>Bundle Analysis</strong> - Analyzes output<ul><li>Reports file sizes<li>Identifies large files<li>Provides optimization recommendations</ul></ol><h2>Build Scripts</h2><pre><code class="language-bash"># Full production build (recommended)
npm run build

# Individual steps
npm run build:eleventy      # Generate HTML
npm run build:optimize      # Run all optimizations
npm run build:minify         # Minify JS and CSS
npm run build:images         # Optimize images
npm run build:fonts          # Subset fonts
npm run build:analyze        # Analyze bundle sizes

# Development
npm run dev                  # Development server
npm run build:no-minify     # Build without minification
</code></pre><h2>Performance Metrics</h2><p>After optimizations, expect:<ul><li><strong>HTML</strong>: 20-30% size reduction<li><strong>JavaScript</strong>: 40-60% size reduction<li><strong>CSS</strong>: 20-30% size reduction<li><strong>Images</strong>: 30-50% size reduction<li><strong>Fonts</strong>: 70-90% size reduction (with subsetting)<li><strong>Total Blocking Time</strong>: Reduced by deferring non-critical work<li><strong>First Contentful Paint</strong>: Improved with critical CSS<li><strong>Repeat Visit Load Time</strong>: 50-80% faster (with service worker)</ul><h2>Additional Optimization Opportunities</h2><h3>High Impact (Recommended)</h3><ol><li><p><strong>GLB Model Compression</strong> - Compress 3D models<pre><code class="language-bash">npm install -D gltf-pipeline
# Compress wisdome.glb for smaller file size
</code></pre><li><p><strong>Service Worker</strong> - Cache static assets<ul><li>Implement offline support<li>Cache strategy for repeat visits</ul><li><p><strong>Resource Hints</strong> - Optimize loading<ul><li><code>preload</code> for critical resources<li><code>prefetch</code> for likely next pages<li><code>dns-prefetch</code> for external domains</ul></ol><h3>Medium Impact</h3><ol start="5"><li><p><strong>CSS Purging</strong> - Remove unused CSS<pre><code class="language-bash">npm install -D @fullhuman/postcss-purgecss
# Remove unused CSS classes
</code></pre><li><p><strong>Code Splitting</strong> - Lazy load modules<ul><li>Split 3D code into separate bundle<li>Load on demand</ul><li><p><strong>Image Format Conversion</strong> - Use modern formats<ul><li>Convert to WebP with fallback<li>Use AVIF for supported browsers</ul><li><p><strong>Gzip/Brotli Compression</strong> - Server-side compression<ul><li>Configure server to compress responses<li>Reduces transfer size by ~70-80%</ul></ol><h3>Low Impact (Nice to Have)</h3><ol start="9"><li><p><strong>Source Maps</strong> - For production debugging<ul><li>Generate source maps for minified code<li>Only include in staging builds</ul><li><p><strong>Bundle Visualization</strong> - Analyze dependencies<pre><code class="language-bash">npm install -D webpack-bundle-analyzer
# Visualize bundle composition
</code></pre><li><p><strong>Lighthouse CI</strong> - Automated performance testing<ul><li>Run Lighthouse on every build<li>Track performance metrics over time</ul></ol><h2>Installation</h2><p>To use all optimizations, install dependencies:<pre><code class="language-bash">npm install
</code></pre><p>Required dependencies:<ul><li><code>sharp</code> - Image optimization<li><code>terser</code> - JavaScript minification<li><code>csso</code> - CSS minification<li><code>html-minifier-next</code> - HTML minification</ul><p>Optional (for analysis):<ul><li><code>jsdom</code> - CSS usage analysis</ul><h2>Build Time</h2><p>Expected build times:<ul><li><strong>Development</strong> (<code>npm run dev</code>): ~1-2 seconds<li><strong>Production</strong> (<code>npm run build</code>): ~5-10 seconds<ul><li>Eleventy: ~2-3s<li>Minification: ~1-2s<li>Image optimization: ~2-5s (depends on image count)</ul></ul><h2>Notes</h2><ul><li>Image optimization requires <code>sharp</code> (native module)<li>CSS analysis requires <code>jsdom</code> (optional)<li>All optimizations are production-only (not in dev mode)<li>Source files are preserved; only output is optimized</ul>