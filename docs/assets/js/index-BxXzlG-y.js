import{a as e,D as t,E as n,F as o,G as i,H as c,I as d,y as s,n as r,q as a,o as m,r as l,s as u,J as f,t as p,K as h,g,f as w,L as y,M as E}from"./chunks/3d-BtkkZ3Vr.js";import{i as v,u as L}from"./chunks/three-addons-NWlwyKh6.js";import{createColorGUI as b}from"./chunks/gui-Cf7HXqQk.js";import{i as k}from"./chunks/dashboard-Cs36tZS6.js";import"./chunks/three-fabxt0FC.js";import"@recast-navigation/core";import"@recast-navigation/three";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver(e=>{for(const n of e)if("childList"===n.type)for(const e of n.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)}).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();let H=!1,x=0;function T(){const e=getComputedStyle(document.documentElement),t=parseFloat(e.getPropertyValue("--row-height"));return!isNaN(t)&&t>0?t:window.innerHeight/10}function M(e){const t=T();return Math.round(e/t)*t}function N(){if(H)return;const e=window.pageYOffset||document.documentElement.scrollTop,t=M(e);Math.abs(e-t)>1&&(H=!0,window.scrollTo({top:t,behavior:"auto"}),setTimeout(()=>{H=!1},50))}function P(e){if(document.body.classList.contains("dome-mode"))return;e.preventDefault();const t=Date.now();if(t-x<50)return;const n=T(),o=window.pageYOffset||document.documentElement.scrollTop,i=e.deltaY;let c=0;if(i>0?c=1:i<0&&(c=-1),0!==c){const e=(Math.round(o/n)+c)*n,i=Math.max(document.body.scrollHeight-window.innerHeight,document.documentElement.scrollHeight-window.innerHeight),d=Math.max(0,Math.min(e,i));Math.abs(d-o)>1&&(x=t,window.scrollTo({top:d,behavior:"auto"}))}}function C(){if(!e.enabled)return;if(document.body.classList.contains("dome-mode"))return;window.addEventListener("wheel",P,{passive:!1});let t=null;window.addEventListener("scroll",()=>{H||(t&&clearTimeout(t),t=setTimeout(()=>{!function(){if(H)return;const e=window.pageYOffset||document.documentElement.scrollTop,t=M(e);Math.abs(e-t)>1&&N()}(),t=null},50))},{passive:!0}),window.addEventListener("load",()=>{setTimeout(()=>{N()},100)}),window.addEventListener("resize",()=>{setTimeout(()=>{N()},100)})}let O=null,z=0,F=0;function q(){const e=getComputedStyle(document.documentElement),t=e.getPropertyValue("--col-width");z=t&&parseFloat(t)||window.innerWidth/15;const n=e.getPropertyValue("--row-height"),o=parseFloat(n);F=!isNaN(o)&&o>0?o:z}function S(){if(!O)return;O.innerHTML="";const e=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight),t=Math.ceil(e/F);for(let n=0;n<t;n++){const e=document.createElement("div");e.className="dot-row";for(let t=0;t<15;t++){const o=document.createElement("div");o.className="animated-dot",o.dataset.col=t+1,o.dataset.row=n+1,o.style.gridColumn=t+1,o.style.gridRow=n+1,e.appendChild(o)}O.appendChild(e)}O.style.height=t*F+"px"}function I(){!function(){const e=document.getElementById("grid-dots-container");e&&e.remove(),O=document.createElement("div"),O.id="grid-dots-container",document.body.appendChild(O),q(),S()}(),window.addEventListener("resize",()=>{q(),S()});let e=0;new MutationObserver(()=>{window.dotsUpdateTimeout&&clearTimeout(window.dotsUpdateTimeout),window.dotsUpdateTimeout=setTimeout(()=>{!function(){const t=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight);Math.abs(t-e)>F&&(e=t,S())}()},500)}).observe(document.body,{childList:!0,subtree:!0}),e=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)}let j=0,D=0;function Y(){const e=window.scrollY||window.pageYOffset||0;document.querySelectorAll(".parallax-item").forEach(t=>{const n=parseFloat(t.dataset.parallaxFactor||"0.4");t.style.transform=`translateY(${e*n*-1}px)`})}function B(){const e=document.getElementById("canvas-container"),t=document.querySelector(".canvas-wrapper");if(!e||!t)return;const n=getComputedStyle(document.documentElement),o=parseFloat(n.getPropertyValue("--row-height")),i=10*(!isNaN(o)&&o>0?o:window.innerHeight/10);e.style.height=`${i}px`,e.style.padding="0",e.style.margin="0",t.style.height=`${i}px`}async function V(){await t(),n(),v(),o(),C(),I(),k(),function(){const e=document.querySelector("main");if(!e)return;const t=document.createTreeWalker(e,NodeFilter.SHOW_TEXT,null,!1),n=[];let o;for(;o=t.nextNode();)o.parentElement?.classList.contains("dome-dreaming-text")||/dome\s+dreaming/i.test(o.textContent)&&n.push(o);n.forEach(e=>{const t=e.parentNode;if(!t)return;const n=e.textContent.split(/(dome\s+dreaming)/gi),o=document.createDocumentFragment();n.forEach(e=>{if(e&&/^dome\s+dreaming$/i.test(e)){const t=document.createElement("span");t.className="dome-dreaming-text",t.textContent=e,o.appendChild(t)}else e&&o.appendChild(document.createTextNode(e))}),t.replaceChild(o,e)})}();const e=document.getElementById("connect-webcam-link");e&&e.addEventListener("click",e=>{e.preventDefault(),h()}),B(),window.addEventListener("resize",B),window.addEventListener("scroll",Y,{passive:!0}),Y(),i(b),j=performance.now(),$(j)}function $(e){requestAnimationFrame($);const t=(e-j)/1e3;j=e,d(),a.x=s.position.x,a.y=s.position.y,a.z=s.position.z,l.x=s.rotation.x,l.y=s.rotation.y,l.z=s.rotation.z;e-D>=2e3&&(Object.assign(r,a),Object.assign(m,l),u(w,g),D=e),f(t),function(e){if(!p.enabled)return;const t=y(),n=E(),o=t||n;if(o){const t=p.speed*p.direction;o.rotation+=t*e}}(t),L()}function A(){const e=document.getElementById("enter-dome-btn"),t=document.body;function n(e=!1){if(t.classList.contains("dome-mode"))return;t.classList.add("dome-mode"),document.documentElement.style.overflow="hidden";const n=document.getElementById("canvas-container");if(n&&(n.style.height="100vh",n.style.width="100vw"),e&&c){const e=c.requestPointerLock||c.mozRequestPointerLock||c.webkitRequestPointerLock;e&&e.call(c)}}function o(){if(t.classList.contains("dome-mode")){t.classList.remove("dome-mode"),document.documentElement.style.overflow="auto";document.getElementById("canvas-container")&&B()}!c||document.pointerLockElement!==c&&document.mozPointerLockElement!==c&&document.webkitPointerLockElement!==c||document.exitPointerLock()}function i(){!(c&&(document.pointerLockElement===c||document.mozPointerLockElement===c||document.webkitPointerLockElement===c))&&t.classList.contains("dome-mode")&&o()}window.enterDomeModeFromCanvas=()=>{n(!0)},e&&c&&e.addEventListener("click",e=>{e.stopPropagation(),n(!0)}),document.addEventListener("keydown",e=>{"Escape"===e.key&&o()}),document.addEventListener("pointerlockchange",i),document.addEventListener("mozpointerlockchange",i),document.addEventListener("webkitpointerlockchange",i)}"loading"===document.readyState?document.addEventListener("DOMContentLoaded",()=>{V(),A()}):(V(),A());
