<h1>Critical CSS Setup Guide</h1><h2>How It Works</h2><h3>1. <strong>Extract Critical CSS</strong> (<code>scripts/extract-critical-css.js</code>)</h3><ul><li>Runs after Eleventy builds<li>Extracts only CSS needed for above-the-fold content:<ul><li>CSS variables (<code>:root</code>)<li>Base styles (<code>html</code>, <code>body</code>)<li>Grid system (<code>.grid</code>, <code>.x-1</code> through <code>.x-12</code>)<li>Loading overlay (<code>#loading-overlay</code>)<li>Canvas container (<code>#canvas-container</code>)<li>First section styles<li>Typography basics<li>Font faces</ul><li>Saves to <code>docs/critical.css</code></ul><h3>2. <strong>Inline Critical CSS</strong> (<code>scripts/inline-critical-css.js</code>)</h3><ul><li>Reads <code>docs/critical.css</code><li>Inlines it in <code>&lt;head></code> as <code>&lt;style></code> tag<li>Sets up async loading for full CSS file<li>Updates <code>docs/index.html</code></ul><h3>3. <strong>Result</strong></h3><p><strong>Before:</strong><pre><code class="language-html">&lt;link rel="stylesheet" href="assets/css/main.css" />
&lt;!-- Blocks rendering until CSS loads -->
</code></pre><p><strong>After:</strong><pre><code class="language-html">&lt;style>
  /* Critical CSS inlined here (~5-10KB) */
  :root { --color-bg: #000000; ... }
  body { font-family: ... }
  /* etc */
&lt;/style>
&lt;link rel="preload" href="assets/css/main.css" as="style" 
      onload="this.onload=null;this.rel='stylesheet'" />
&lt;noscript>&lt;link rel="stylesheet" href="assets/css/main.css" />&lt;/noscript>
&lt;!-- Full CSS loads asynchronously, doesn't block rendering -->
</code></pre><h2>Benefits</h2><ol><li><p><strong>Faster First Contentful Paint (FCP)</strong><ul><li>Page renders immediately with critical styles<li>No waiting for full CSS file</ul><li><p><strong>Better User Experience</strong><ul><li>Users see content faster<li>Progressive enhancement (styles load in background)</ul><li><p><strong>Performance Score Improvement</strong><ul><li>Reduces render-blocking resources<li>Improves Lighthouse score</ul></ol><h2>Build Process</h2><p>The build script now runs:<ol><li>Eleventy builds site → <code>docs/</code><li>Cleanup unused files<li>Minify JavaScript<li><strong>Extract critical CSS</strong> → <code>docs/critical.css</code><li><strong>Inline critical CSS</strong> → Updates <code>docs/index.html</code></ol><h2>How to Use</h2><p>Just run your normal build:<pre><code class="language-bash">npm run build
</code></pre><p>The critical CSS extraction and inlining happens automatically!<h2>Manual Testing</h2><p>To test if it's working:<ol><li>Build the site: <code>npm run build</code><li>Check <code>docs/index.html</code> - should have <code>&lt;style></code> tag with critical CSS<li>Check that full CSS loads asynchronously (check Network tab in DevTools)<li>Verify page renders immediately without waiting for CSS</ol><h2>Troubleshooting</h2><p><strong>If critical CSS is too large:</strong><ul><li>Adjust selectors in <code>extract-critical-css.js</code><li>Remove non-essential styles from extraction</ul><p><strong>If styles are missing:</strong><ul><li>Add missing selectors to extraction script<li>Check that CSS file paths are correct</ul><p><strong>If async loading doesn't work:</strong><ul><li>Check browser console for errors<li>Verify <code>loadCSS</code> polyfill is included<li>Test with JavaScript disabled (should use <code>&lt;noscript></code> fallback)</ul>