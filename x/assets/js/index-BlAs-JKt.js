import{d as e,l as t,e as n,f as o,g as i,h as d,u as c,c as s,i as r,j as a,k as m,m as l,n as u,o as f,t as p,p as h,q as g,v as w,w as y,x as E}from"./chunks/3d-YBF0PZ89.js";import{i as v,u as L}from"./chunks/three-addons-bh36ixWv.js";import{i as b}from"./chunks/dashboard-Cs36tZS6.js";import"./chunks/three-fabxt0FC.js";import"@recast-navigation/core";import"@recast-navigation/three";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver(e=>{for(const n of e)if("childList"===n.type)for(const e of n.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)}).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();let k=!1,x=0;function H(){const e=getComputedStyle(document.documentElement),t=parseFloat(e.getPropertyValue("--row-height"));return!isNaN(t)&&t>0?t:window.innerHeight/10}function T(e){const t=H();return Math.round(e/t)*t}function M(){if(k)return;const e=window.pageYOffset||document.documentElement.scrollTop,t=T(e);Math.abs(e-t)>1&&(k=!0,window.scrollTo({top:t,behavior:"auto"}),setTimeout(()=>{k=!1},50))}function N(e){if(document.body.classList.contains("dome-mode"))return;e.preventDefault();const t=Date.now();if(t-x<50)return;const n=H(),o=window.pageYOffset||document.documentElement.scrollTop,i=e.deltaY;let d=0;if(i>0?d=1:i<0&&(d=-1),0!==d){const e=(Math.round(o/n)+d)*n,i=Math.max(document.body.scrollHeight-window.innerHeight,document.documentElement.scrollHeight-window.innerHeight),c=Math.max(0,Math.min(e,i));Math.abs(c-o)>1&&(x=t,window.scrollTo({top:c,behavior:"auto"}))}}function P(){if(!e.enabled)return;if(document.body.classList.contains("dome-mode"))return;window.addEventListener("wheel",N,{passive:!1});let t=null;window.addEventListener("scroll",()=>{k||(t&&clearTimeout(t),t=setTimeout(()=>{!function(){if(k)return;const e=window.pageYOffset||document.documentElement.scrollTop,t=T(e);Math.abs(e-t)>1&&M()}(),t=null},50))},{passive:!0}),window.addEventListener("load",()=>{setTimeout(()=>{M()},100)}),window.addEventListener("resize",()=>{setTimeout(()=>{M()},100)})}let C=null,O=0,z=0;function F(){const e=getComputedStyle(document.documentElement),t=e.getPropertyValue("--col-width");O=t&&parseFloat(t)||window.innerWidth/15;const n=e.getPropertyValue("--row-height"),o=parseFloat(n);z=!isNaN(o)&&o>0?o:O}function q(){if(!C)return;C.innerHTML="";const e=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight),t=Math.ceil(e/z);for(let n=0;n<t;n++){const e=document.createElement("div");e.className="dot-row";for(let t=0;t<15;t++){const o=document.createElement("div");o.className="animated-dot",o.dataset.col=t+1,o.dataset.row=n+1,o.style.gridColumn=t+1,o.style.gridRow=n+1,o.style.pointerEvents="none",e.appendChild(o)}C.appendChild(e)}C.style.height=t*z+"px"}function S(){!function(){const e=document.getElementById("grid-dots-container");e&&e.remove(),C=document.createElement("div"),C.id="grid-dots-container",document.body.appendChild(C),F(),q()}(),window.addEventListener("resize",()=>{F(),q()});let e=0;new MutationObserver(()=>{window.dotsUpdateTimeout&&clearTimeout(window.dotsUpdateTimeout),window.dotsUpdateTimeout=setTimeout(()=>{!function(){const t=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight);Math.abs(t-e)>z&&(e=t,q())}()},500)}).observe(document.body,{childList:!0,subtree:!0}),e=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)}let j=0,I=0;function Y(){const e=window.scrollY||window.pageYOffset||0;document.querySelectorAll(".parallax-item").forEach(t=>{const n=parseFloat(t.dataset.parallaxFactor||"0.4");t.style.transform=`translateY(${e*n*-1}px)`})}function B(){const e=document.getElementById("canvas-container"),t=document.querySelector(".canvas-wrapper");if(!e||!t)return;const n=getComputedStyle(document.documentElement),o=parseFloat(n.getPropertyValue("--row-height")),i=10*(!isNaN(o)&&o>0?o:window.innerHeight/10);e.style.height=`${i}px`,e.style.padding="0",e.style.margin="0",t.style.height=`${i}px`}async function D(){await t(),n(),v(),o(),P(),S(),b(),function(){const e=document.querySelector("main");if(!e)return;const t=document.createTreeWalker(e,NodeFilter.SHOW_TEXT,null,!1),n=[];let o;for(;o=t.nextNode();)o.parentElement?.classList.contains("dome-dreaming-text")||/dome\s+dreaming/i.test(o.textContent)&&n.push(o);n.forEach(e=>{const t=e.parentNode;if(!t)return;const n=e.textContent.split(/(dome\s+dreaming)/gi),o=document.createDocumentFragment();n.forEach(e=>{if(e&&/^dome\s+dreaming$/i.test(e)){const t=document.createElement("span");t.className="dome-dreaming-text",t.textContent=e,o.appendChild(t)}else e&&o.appendChild(document.createTextNode(e))}),t.replaceChild(o,e)})}();const e=document.getElementById("connect-webcam-link");e&&e.addEventListener("click",e=>{e.preventDefault(),h()}),B(),window.addEventListener("resize",B),window.addEventListener("scroll",Y,{passive:!0}),Y(),i(),j=performance.now(),V(j)}function V(e){requestAnimationFrame(V);const t=(e-j)/1e3;j=e,c(),a.x=s.position.x,a.y=s.position.y,a.z=s.position.z,l.x=s.rotation.x,l.y=s.rotation.y,l.z=s.rotation.z;e-I>=2e3&&(Object.assign(r,a),Object.assign(m,l),u(w,g),I=e),f(t),function(e){if(!p.enabled)return;const t=y(),n=E(),o=t||n;if(o){const t=p.speed*p.direction;o.rotation+=t*e}}(t),L()}function $(){const e=document.getElementById("enter-dome-btn"),t=document.body;function n(e=!1){if(t.classList.contains("dome-mode"))return;t.classList.add("dome-mode"),document.documentElement.style.overflow="hidden";const n=document.getElementById("canvas-container");if(n&&(n.style.height="100vh",n.style.width="100vw"),e&&d){const e=d.requestPointerLock||d.mozRequestPointerLock||d.webkitRequestPointerLock;e&&e.call(d)}}function o(){if(t.classList.contains("dome-mode")){t.classList.remove("dome-mode"),document.documentElement.style.overflow="auto";document.getElementById("canvas-container")&&B()}!d||document.pointerLockElement!==d&&document.mozPointerLockElement!==d&&document.webkitPointerLockElement!==d||document.exitPointerLock()}function i(){!(d&&(document.pointerLockElement===d||document.mozPointerLockElement===d||document.webkitPointerLockElement===d))&&t.classList.contains("dome-mode")&&o()}window.enterDomeModeFromCanvas=()=>{n(!0)},e&&d&&e.addEventListener("click",e=>{e.stopPropagation(),n(!0)}),document.addEventListener("keydown",e=>{"Escape"===e.key&&o()}),document.addEventListener("pointerlockchange",i),document.addEventListener("mozpointerlockchange",i),document.addEventListener("webkitpointerlockchange",i)}"loading"===document.readyState?document.addEventListener("DOMContentLoaded",()=>{D(),$()}):(D(),$());
